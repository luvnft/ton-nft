"Asm.fif" include

// Simple SmartContractInfo structure emulation
{ | | 0x076ef1ea , 0 , 0 , now , 0 , now , now , 100 0 pair , , } : BuildSmartContractInfo

// Standard function selectors
-1 constant recv_external_selector
0 constant recv_internal_selector
0 constant main_selector

PROGRAM{
  DECLPROC recv_internal
  DECLPROC recv_external
  DECLPROC store_data
  DECLPROC load_data
  107853 DECLMETHOD get_name
  72444 DECLMETHOD get_symbol
  107065 DECLMETHOD get_content
  111475 DECLMETHOD get_contract_id
  recv_internal PROC:<{
    //  msg_value in_msg_cell in_msg
    2 1 BLKDROP2	//  in_msg
    SEMPTY	//  _3
    IFJMP:<{	//
    }>	//
  }>
  recv_external PROC:<{
    //  in_msg
    DROP	//
    c4 PUSH	//  _2
    CTOS	//  ds
    1 LDU	//  inited ds
    LDREF	//  inited _26 _25
    NIP	//  inited ds
    LDREF	//  inited _28 _27
    NIP	//  inited ds
    LDREF	//  inited _30 _29
    NIP	//  inited ds
    ENDS
    33 THROWIF
    ACCEPT
  }>
  store_data PROC:<{
    //  ds ds ds
    //  name symbol content
    1 PUSHINT	//  name symbol content _4=1
    NEWC	//  name symbol content _4=1 _5
    1 STU	//  name symbol content _7
    s1 s3 XCHG	//  content symbol name _7
    STREF	//  content symbol _8
    STREF	//  content _9
    STREF	//  _10
    ENDC	//  _11
    c4 POP
  }>
  load_data PROC:<{
    //
    c4 PUSH	//  _1
    CTOS	//  ds
    1 LDU	//  _16 _15
    NIP	//  ds
    LDREF	//  _8 ds
    LDREF	//  _8 _10 ds
    LDREF	//  res res res ds
    ENDS
  }>
  get_name PROC:<{
    //
    load_data CALLDICT	//  _5 _6 _7
    2DROP	//  name
    CTOS	//  _4
  }>
  get_symbol PROC:<{
    //
    load_data CALLDICT	//  _5 _6 _7
    DROP
    NIP	//  symbol
    CTOS	//  _4
  }>
  get_content PROC:<{
    //
    load_data CALLDICT	//  _5 _6 _7
    2 1 BLKDROP2	//  content
    CTOS	//  _4
  }>
  get_contract_id PROC:<{
    //
    20 PUSHPOW2DEC	//  _0=1048575
    0 PUSHINT	//  _0=1048575 _1=0
  }>
}END>c


<s constant Code

<b "Test Token" $, b> constant tokenName
<b "TSTKN" $, b> constant tokenSymbol
<b "Some url" $, b> constant tokenContent

<b
    1 1 u,  // initialized
    // 0 32 u, // seqno
    tokenName ref,
    tokenSymbol ref,
    tokenContent ref,
b> constant Data


107065
Code
Data
BuildSmartContractInfo
runvmctx
<s
.s

s>c
boc>B
.s
// drop    // drop new Data
// drop    // drop return code

// dup sbits 8 / // Fetch slice length in bits and compute length in bytes

// $@

// .s