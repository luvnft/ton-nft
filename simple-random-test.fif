"Asm.fif" include

// Simple SmartContractInfo structure emulation
{ | | 0x076ef1ea , 0 , 0 , now , 0 , now , now , 100 0 pair , , } : BuildSmartContractInfo

//
// Executes code in TVM & emulates SmartContractInfo in c7 register
// [proc_args], proc_selector, code, persisted_data runvm() -> exception_code, ?persisted_data
//
{

    <{
        c7 POP  // Set c7 register from stack
    }>s

    // Concat code peaces
    rot <s |+ swap

    // Position SmartContractInfo struct to the top after running vm
    BuildSmartContractInfo -rot

    // Run VM
    runvm
} : runvm()


PROGRAM{
  DECLPROC recv_internal
  DECLPROC recv_external
  90230 DECLMETHOD get_random
  recv_internal PROC:<{
    //  in_msg
    DROP	//
  }>
  recv_external PROC:<{
    //  in_msg
    DROP	//
  }>
  get_random PROC:<{
    //
    RANDU256	//  _0
  }>
}END>c


<s constant Code

// 90230
// <s Code
// <b b>
// runvm

-1 constant recv_external_selector
0 constant recv_internal_selector
0 constant main_selector

777
recv_external_selector
Code
<b b>
BuildSmartContractInfo
runvmctx
<s
.s